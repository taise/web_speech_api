!function(){var t=new webkitSpeechRecognition;t.lang="ja-JP",t.continuous=!0,t.interimResults=!0;var n=0,e="read";$("#select-lang").change(function(){t.lang=$("#select-lang").val(),console.log(t.lang)}),$("#start").click(function(){t.start(),$("#state").text("start")}),$("#stop").click(function(){t.stop()}),t.onsoundstart=function(){$("#state").text("listening...")},t.onsoundend=function(){$("#state").text("stop")},t.onnomatch=function(){$("#speaking").text("Could you speak more slowly, please?")},t.onerror=function(){$("#state").text("error"),$("#speaking").text("error")},t.onresult=function(t){n+=1;for(var e="sentence_"+n,a=t.results,r=t.resultIndex;r<a.length;r++)$("#speaking").text(a[r][0].transcript),1==a[r].isFinal&&(o(e),i(e))};var o=function(t){var n=$("#speaking").clone().removeAttr("id").attr("id",t).addClass("sentence");$("#text").append(n)},a=function(t,n){t.text(n.val()),n.remove(),e="read"},i=function(t){var n=$("#"+t),o=r(t);n.click(function(){if("read"===e){e="edit",n.after(o);var i=$("#edit_"+t);i.focus(),i.blur(function(){a(n,i)}),i.keypress(function(t){13==t.keyCode&&a(n,i)})}})},r=function(t){return"<input id='edit_"+t+"' class='form-control'type='text' value='"+$("#"+t).text()+"'/>"}}();